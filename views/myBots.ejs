
<%- include('partials/header') %>

<ul>
  <% bots.forEach(bot => { %>
    <li>
      <strong><%= bot.name %></strong> — <%= bot.type %> — <%= bot.visibility %>
       <p><strong>Description:</strong> <%= bot.description || "No description" %></p>

      <!-- Delete Form -->
      <form action="/bot/<%= bot._id %>/delete" method="POST" style="display:inline;">
        <button type="submit" onclick="return confirm('Are you sure you want to delete this bot?');">Delete</button>
      </form>

      <!-- Optional: Chat or Edit buttons -->
      <a href="/bot/<%= bot._id %>/chat">Chat</a>
      <a href="/bot/<%= bot._id %>/edit">Edit</a>
      <!-- <a href="/embed/<%= bot._id %>" >Embed</a> -->
      <!-- Embed Button -->
<button onclick="openEmbedModal('<%= bot._id %>')">Embed</button>

<!-- Embed Modal -->
<div id="embedModal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.5); justify-content:center; align-items:center;">
  <div style="background:#fff; padding:20px; border-radius:10px; max-width:600px; width:90%; position:relative;">
    <h3>Embed Your Chatbot</h3>
    <textarea id="embedCode" readonly style="width:100%; height:120px; padding:10px; border-radius:5px; font-family:monospace;"></textarea>
    <br />
    <button onclick="copyEmbedCode()">Copy to Clipboard</button>
    <button onclick="closeEmbedModal()" style="float:right;">Close</button>
  </div>
</div>


    </li>
  <% }) %>
</ul>
<script>
    function openEmbedModal(botId) {
    const baseUrl = '<%= process.env.BASE_URL %>';
    const embedCode = `<iframe 
  src="${baseUrl}/bot/${botId}/chat/embed"
  width="400"
  height="500"
  style="border: none; border-radius: 10px;"
  allow="microphone; camera"
></iframe>`;

    document.getElementById('embedCode').value = embedCode;
    document.getElementById('embedModal').style.display = 'flex';
  }

  function closeEmbedModal() {
    document.getElementById('embedModal').style.display = 'none';
  }

  function copyEmbedCode() {
    const textarea = document.getElementById('embedCode');
    textarea.select();
    document.execCommand('copy');
    alert('Embed code copied to clipboard!');
  }
</script>

<%- include('partials/footer') %>

